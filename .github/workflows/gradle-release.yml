name: Gradle initScript release

on:
  workflow_dispatch:

jobs:
  determine-version:
    runs-on: ubuntu-latest
    outputs:
      version: ${{ steps.read-version.outputs.version }}
    steps:
      - uses: actions/checkout@v4

      - name: read-version
        id: read-version
        shell: bash
        run: |
          INIT_SCRIPT_VERSION=$(awk '/Version:/ {print $NF}' reference/develocity-injection.init.gradle)
          echo "version=$INIT_SCRIPT_VERSION" >> "$GITHUB_OUTPUT"
          
  print-version:
    needs: [determine-version]
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "version is ${{ needs.determine-version.outputs.version }}"
